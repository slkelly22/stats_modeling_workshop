---
title: "Stats Modeling in R: Week 4"
author: "S.Kelly"
format:
  revealjs:
    html-math-method:
      method: mathjax
      url: "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    code-overflow: wrap
    footer: "S.Kelly | Stats Modeling in R | Fall 2025"
editor: visual
execute: 
  echo: true
---

## Visualizing Correlation

We're going to install and load the `corrplot` and `usdata` packages. Also load the `tidyverse`.

```{r}
# install.packages("corrplot", "usdata")
library(corrplot)
library(usdata)
library(tidyverse)
```

## County Dataset

There is a `county` dataset inside the usdata package that we want to use. Let's take a look at the variables.

```{r}
summary(county)
```

## Visualizing Correlation

We only want the numeric variables for our correlation plot so let's create a new object.

```{r}
county_numeric <- county |> 
  select_if(is.numeric)

head(county_numeric)
```

## Visualizing Correlation

```{r}
corrplot(cor(county_numeric, use = "complete.obs"), method = "pie", 
         type = "upper")
```

## Exercise: Make a Corr Plot

Look at the help menu for the `corrplot` function and change the method argument to something other than "pie".

```{r}
#| echo: TRUE
#| eval: FALSE
corrplot(cor(county_numeric, use = "complete.obs"), method = "?", 
         type = "upper")
```

## Next: Interactions

We're going to explore a relatively new R packaged called `interactions`. You can find details at interactions.jacob-long.com. The creator of this package is a faculty member at University of South Carolina.

```{r}
# install.packages("interactions")
library(interactions)
```


## Regression with an Interaction

Outcome: Unemployment Rate \
Predictors: Homeownership, Median Education, and the interaction between the two predictors

```{r}
modelA <- lm(unemployment_rate ~ homeownership + median_edu + 
               homeownership:median_edu, data = county)

levels(county$median_edu) # keep this is mind
```

## Regression with an Interaction

```{r}
summary(modelA) 
```

## Visualizing the Interaction

Why does this look insane? 
```{r}
interact_plot(modelA, pred = homeownership, modx = median_edu, 
              jnplot = TRUE)
```

## This is why...

```{r}
fct_count(county$median_edu)
```

## County Dataset

We're going to continue working with the county dataset but first we need to drop two rows prior to modeling our factors.

```{r}
# There are only two counties (out of 3K) 
# with a median education less than high school. 

nohs_county <- county |> 
  filter(median_edu != "below_hs")

levels(nohs_county$median_edu)
```
